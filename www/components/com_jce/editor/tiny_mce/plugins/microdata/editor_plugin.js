/* microdata - 1.0.10 | 19 December 2015 | http://www.joomlacontenteditor.net | Copyright (C) 2006 - 2015 Ryan Demmer. All rights reserved | GNU/GPL Version 2 - http://www.gnu.org/licenses/gpl-2.0.html */
(function(){var each=tinymce.each,extend=tinymce.extend;tinymce.create('tinymce.plugins.MicrodataPlugin',{init:function(ed,url){var self=this;this.editor=ed;function isMicrodata(n){return n.getAttribute('itemprop')||n.getAttribute('data-microdata-itemprop');}
ed.addCommand('mceMicrodata',function(){var se=ed.selection,n=se.getNode();ed.windowManager.open({file:ed.getParam('site_url')+'index.php?option=com_jce&view=editor&layout=plugin&plugin=microdata',width:400+ed.getLang('microdata.delta_width',0),height:300+ed.getLang('microdata.delta_height',0),inline:1,popup_css:false},{plugin_url:url});});ed.addButton('microdata',{title:'microdata.desc',cmd:'mceMicrodata',image:url+'/img/microdata.png'});ed.onNodeChange.add(function(ed,cm,n,co){cm.setDisabled('microdata',co);});ed.onInit.add(function(ed){if(!ed.settings.compress.css){ed.dom.loadCSS(url+"/css/content.css");}});ed.onPreInit.add(function(){ed.schema.addValidElements('@[itemscope=itemscope|itemtype|itemid|itemprop|itemref]');each(ed.schema.elements,function(v,k){if(/\w+/.test(k)&&v.attributes){extend(v.attributes,{'itemscope':{'defaultValue':'itemscope'},'itemtype':{},'itemid':{},'itemprop':{},'itemref':{}});v.attributesOrder.concat(v.attributesOrder,['itemscope','itemtype','itemid','itemprop','itemref']);}});ed.serializer.addAttributeFilter('data-microdata-itemscope,data-microdata-itemtype,data-microdata-itemid,data-microdata-itemprop,data-microdata-itemref',function(nodes,name){var i=nodes.length,node,k,v;while(i--){node=nodes[i],k=name.replace('data-microdata-','');v=node.attr(name);if(k==='itemtype'){node.attr('itemscope','itemscope');if(v.indexOf('http://')===-1){v='http://schema.org/'+v;}}
node.attr(k,v);node.attr(name,null);}});ed.parser.addAttributeFilter('itemscope,itemtype,itemid,itemprop,itemref',function(nodes,name){var i=nodes.length,node,v;while(i--){node=nodes[i];v=node.attr(name);if(name==='itemscope'){v='itemscope';}
if(name==='itemtype'&&v.indexOf('http://')===-1){v='http://schema.org/'+v;}
node.attr('data-microdata-'+name,v);node.attr(name,null);}});ed.formatter.register({'microdata':{inline:'span',onformat:function(elm,fmt,vars){each(vars,function(value,key){ed.dom.setAttrib(elm,key,value);});}},'microdata-remove':{selector:'span',attributes:['data-microdata-itemprop'],remove:'emtpy'}});});},getInfo:function(){return{longname:'Microdata',author:'Ryan Demmer',authorurl:'http://www.joomlacontenteditor.net',infourl:'http://www.joomlacontenteditor.net',version:'1.0.10'};}});tinymce.PluginManager.add('microdata',tinymce.plugins.MicrodataPlugin);})();